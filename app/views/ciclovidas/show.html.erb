<div class="right_col" role="main">
  <div class="">
    <div class="page-title">
      <div class="title_left">
        <h3>Estoque da <%= current_user.cliente.nome_cervejaria %></h3>
      </div>
    </div>
    <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="x_panel">
        <div class="x_title">
          <h2>Estoque de barris</h2>
          <div class="clearfix"></div>
        </div>
        <div class="x_content">
          <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
            <thead>
              <tr>
                <th>Id do item</th>
                <th>Item</th>
                <th>Localização do produto</th>
                <th>Tempo no cliente, caso fora da fábrica</th>
                <th>Tipo de cerveja, caso barril esteja na câmara fria</th>
                <th>Data da última atualização</th>
              </tr>
            </thead>
            <tbody>
              <% @ciclovida.each do |ciclovida| %>
                <tr>
                  <td><%= ciclovida.id %></td>
                  <td><%= ciclovida.item.item_name %></td>
                  <td><%= ciclovida.localizacao %></td>
                  <% if ciclovida.localizacao == "Estoque final. Sujo e vazio" || ciclovida.localizacao == "Estoque de barris. Limpo e vazio" || ciclovida.localizacao == "Câmara fria. Cheio" %>
                    <td><%= " " %></td>
                  <% else %>
                  <% tempo_no_cliente = (Time.current.day - ciclovida.updated_at.day).to_i %>
                    <td><%= tempo_no_cliente.to_s + " dias" %></td>
                    
                  <% end %>
                  <td><%= ciclovida.tipo_cerveja %></td>
                  <td><%= ciclovida.updated_at.to_date %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="x_panel">
        <div class="x_title">
          <h2>Barris fora da fábrica a mais tempo</h2>
          <div class="clearfix"></div>
        </div>
        <div class="x_content">
          <table id="datatable-responsive2" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
            <thead>
              <tr>
                <th>Id do item</th>
                <th>Item</th>
                <th>Localização do produto</th>
                <th>Tempo no cliente, caso fora da fábrica</th>
                <th>Tipo de cerveja, caso barril esteja na câmara fria</th>
                <th>Data da última atualização</th>
              </tr>
            </thead>
            <tbody>
              <% @ciclovida.each do |ciclovida| %>
                <% tempo_no_cliente = (Time.current.day - ciclovida.updated_at.day).to_i %>
                <% if ciclovida.localizacao != "Estoque final. Sujo e vazio" && ciclovida.localizacao != "Estoque de barris. Limpo e vazio" && ciclovida.localizacao != "Câmara fria. Cheio" && tempo_no_cliente >= 5 %>
                  <tr>
                    <td><%= ciclovida.id %></td>
                    <td><%= ciclovida.item.item_name %></td>
                    <td><%= ciclovida.localizacao %></td>
                    <td><%= tempo_no_cliente.to_s + " dias" %></td>
                    <td><%= ciclovida.tipo_cerveja %></td>
                    <td><%= ciclovida.updated_at.to_date %></td>
                  </tr>
                <% end %>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
  </div>
</div>

<script>
  var handleDataTableButtons = function() {
      "use strict";
      0 !== $("#datatable-buttons").length && $("#datatable-buttons").DataTable({
        dom: "Bfrtip",
        buttons: [{
          extend: "copy",
          className: "btn-sm"
        }, {
          extend: "csv",
          className: "btn-sm"
        }, {
          extend: "excel",
          className: "btn-sm"
        }, {
          extend: "pdf",
          className: "btn-sm"
        }, {
          extend: "print",
          className: "btn-sm"
        }],
        responsive: !0
      })
    },
    TableManageButtons = function() {
      "use strict";
      return {
        init: function() {
          handleDataTableButtons()
        }
      }
    }();
</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('#datatable').dataTable();
    $('#datatable-keytable').DataTable({
      keys: true
    });
    $('#datatable-responsive').DataTable();
    $('#datatable-responsive2').DataTable();
    $('#datatable-responsive3').DataTable();
    $('#datatable-scroller').DataTable({
      ajax: "js/datatables/json/scroller-demo.json",
      deferRender: true,
      scrollY: 380,
      scrollCollapse: true,
      scroller: true
    });
    var table = $('#datatable-fixed-header').DataTable({
      fixedHeader: true
    });
  });
  TableManageButtons.init();
</script>



